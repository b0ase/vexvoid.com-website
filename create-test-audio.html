<!DOCTYPE html>
<html>
<head>
    <title>Create Test Audio</title>
</head>
<body>
    <h1>Creating Test Audio File</h1>
    <div id="status">Initializing...</div>
    
    <script>
        // Create a simple sine wave audio
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const sampleRate = audioContext.sampleRate;
        const duration = 5; // 5 seconds
        const frequency = 440; // A4 note
        
        const buffer = audioContext.createBuffer(1, sampleRate * duration, sampleRate);
        const channelData = buffer.getChannelData(0);
        
        for (let i = 0; i < buffer.length; i++) {
            channelData[i] = Math.sin(2 * Math.PI * frequency * i / sampleRate);
        }
        
        // Convert to WAV format
        function bufferToWave(buffer, len) {
            const numOfChan = buffer.numberOfChannels;
            const length = len * numOfChan * 2;
            const buffer16Bit = new Int16Array(length);
            const sample = (len) => Math.min(1, Math.max(-1, len));
            let index = 0;
            
            for (let i = 0; i < len; i++) {
                for (let channel = 0; channel < numOfChan; channel++) {
                    buffer16Bit[index] = sample(buffer.getChannelData(channel)[i]) * 0x7FFF;
                    index++;
                }
            }
            
            return buffer16Bit;
        }
        
        function createWAVBlob(buffer) {
            const data = bufferToWave(buffer, buffer.length);
            const wav = new ArrayBuffer(44 + data.length * 2);
            const view = new DataView(wav);
            
            // WAV header
            const writeString = (offset, string) => {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            };
            
            writeString(0, 'RIFF');
            view.setUint32(4, 36 + data.length * 2, true);
            writeString(8, 'WAVE');
            writeString(12, 'fmt ');
            view.setUint32(16, 16, true);
            view.setUint16(20, 1, true);
            view.setUint16(22, 1, true);
            view.setUint32(24, sampleRate, true);
            view.setUint32(28, sampleRate * 2, true);
            view.setUint16(32, 2, true);
            view.setUint16(34, 16, true);
            writeString(36, 'data');
            view.setUint32(40, data.length * 2, true);
            
            // Write audio data
            for (let i = 0; i < data.length; i++) {
                view.setInt16(44 + i * 2, data[i], true);
            }
            
            return new Blob([wav], { type: 'audio/wav' });
        }
        
        // Create and download the file
        const blob = createWAVBlob(buffer);
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'test-track.wav';
        a.click();
        
        document.getElementById('status').innerHTML = 'Test audio file created and downloaded!';
    </script>
</body>
</html> 